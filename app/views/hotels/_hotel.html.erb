<%
   landmark       ||= @default_landmark
   landmark_link  ||= nil
   img              = hotel.gallery.title.image_url(:small) rescue nil
%>

<div class="hotel-item clearfix">
  <div class="row">
    <div class="col-lg-10 col-lg-offset-2">
      <h3>
        <%= link_to hotel.node.header, node_path(hotel.node.name) %>
        <small><%= hotel.type.name rescue '' %>, <%= hotel.city.name %></small>
      </h3>
    </div>
    <div class="col-lg-3">

    </div>
  </div>
  <div class="row">
    <div class="col-lg-2">
      <%= image_tag(img, class: 'img-rounded thumbnail') if img %>
    </div>

    <div class="col-lg-10 details">

      <div class="row">
        <div class="col-lg-9">
          <span class="distance" data-toggle="tooltip" data-placement="bottom" title="Distance does not consider road connections">
            <%= distance_between(hotel, landmark, landmark_link) if landmark.present? %>
          </span>
        </div>
      </div>
      <% if hotel.rooms.present? %>
        <% hotel.rooms.take(4).each do |room| %>
          <div class="row room">
            <div class="col-lg-10">
              <%= link_to room.caption, slug_hotel_room_path(hotel, room) %>
            </div>
            <div class="col-lg-2 price">
              <% room.prices.each do |price| %>
                <% closed = price.period != hotel.current_period ? ' closed' : '' %>
                <%= content_tag_for(:span, price, class: "period_#{price.period.id} #{closed}") do %>
                  <%= price.value %>
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
        <% if hotel.rooms.count > 4 %>
          <div class="row">
            <div class="col-lg-10">
              <%= link_to "See all rooms (#{hotel.rooms.count})", slug_hotel_rooms_path(hotel) %>
            </div>
          </div>
        <% end %>

        <div class="row periods">
          <div class="col-lg-9">
            Prices are shown by period:
          </div>
          <div class="col-lg-3">
            <% if hotel.periods.present? %>
              <div class="btn-group pull-right">
                <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown">
                  <%= hotel.current_period.title %> <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu">
                  <% hotel.periods.each do |period| %>
                    <%= content_tag_for(:li, period, class: period == hotel.current_period ? 'active' : nil) do %>
                      <a href="#"><%= period.title %></a>
                    <% end %>
                  <% end %>
                </ul>
              </div>
            <% end %>
          </div>
        </div>

      <% end %>

    </div>
  </div>


</div>