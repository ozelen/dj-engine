<% if defined?(:current_user) && current_user %>

<p id="add_comment_button">
  <button class="btn btn-default" onclick="$('#add_comment_form').show(); $('#add_comment_button').hide()">Add a comment</button>
</p>


<fieldset id="add_comment_form" style="display: none">
  <legend>Create new comment</legend>
  <%= form_for Comment.new, remote: true do |f| %>

    <div class="form-group">
      <%= f.label :title, class: 'sr-only' %>
      <%= f.text_field :title, class: 'form-control', placeholder: 'Title' %>
    </div>

    <div class="form-group">
      <%= f.label :body, class: 'sr-only' %>
      <%= f.text_area :body, rows: 3, class: 'form-control', placeholder: 'Message' %>
    </div>

    <%= hidden_field_tag 'commentable_type',  commentable.class.to_s %>
    <%= hidden_field_tag 'commentable_id',    commentable.id %>

    <%= f.submit 'Submit', class: 'btn btn-primary' %>
    <button type="button" class="btn btn-default" onclick="$('#add_comment_form').hide(); $('#add_comment_button').show()">Cancel</button>
    <hr>
  <% end %>
</fieldset>


<% else %>

  <%= t 'comments.to_leave_a_comment_you_need_to' %> <%= link_to t('comments.register'), new_user_registration_path %>
  <hr>

<% end %>

<% comments = commentable.comment_threads.paginate(page: params[:page], per_page: 10) %>

<%= will_paginate comments, renderer: BootstrapPagination::Rails, bootstrap: 3 %>

<div id="comments">
  <% comments.each do |comment| %>
    <%= render comment %>
  <% end %>
</div>

<%= will_paginate comments, renderer: BootstrapPagination::Rails, bootstrap: 3 %>